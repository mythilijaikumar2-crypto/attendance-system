<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NxtSync - Attendance Dashboard</title>
    <link rel="stylesheet" href="./employee-style.css" onerror="console.error('Failed to load CSS: ' + this.href)">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" onerror="console.error('Failed to load CSS: ' + this.href)">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" onerror="console.error('Failed to load CSS: ' + this.href)">
<script src="https://cdn.jsdelivr.net/npm/exif-js"></script>
</head>
<body>
    <div class="dashboard-container">
        <div class="mobile-menu-overlay" id="mobileMenuOverlay">
            <div class="mobile-menu-header">
                <button class="mobile-menu-close" id="mobileMenuClose" title="Close menu">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <nav class="mobile-nav">
                <ul class="mobile-nav-list">
                    <li class="mobile-nav-item active">
                        <a href="#dashboard" class="mobile-nav-link">
                            <i class="fas fa-th-large"></i>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    <li class="mobile-nav-item">
                        <a href="#attendance" class="mobile-nav-link">
                            <i class="fas fa-user-check"></i>
                            <span>Attendance</span>
                        </a>
                    </li>
                    <li class="mobile-nav-item">
                        <a href="#present" class="mobile-nav-link">
                            <i class="fas fa-check-circle"></i>
                            <span>Present Today</span>
                        </a>
                    </li>
                    <li class="mobile-nav-item">
                        <a href="#absent" class="mobile-nav-link">
                            <i class="fas fa-times-circle"></i>
                            <span>Absent Today</span>
                        </a>
                    </li>
                    <li class="mobile-nav-item">
                        <a href="#leave" class="mobile-nav-link">
                            <i class="fas fa-calendar-alt"></i>
                            <span>Leave Requests</span>
                        </a>
                    </li>
                    <li class="mobile-nav-item">
                        <a href="#reports" class="mobile-nav-link">
                            <i class="fas fa-chart-bar"></i>
                            <span>Reports</span>
                        </a>
                    </li>
                    <li class="mobile-nav-item">
                        <a href="#activity" class="mobile-nav-link">
                            <i class="fas fa-bell"></i>
                            <span>Recent Activity</span>
                        </a>
                    </li>
                    <li class="mobile-nav-item">
                        <a href="#late-members" class="mobile-nav-link">
                            <i class="fas fa-clock"></i>
                            <span>Late Members Today</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>

        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo-container">
                    <img src="./logo.jpg" alt="NxtSync Logo">
                </div>
            </div>
            <nav class="sidebar-nav">
                <ul class="nav-list">
                    <li class="nav-item active">
                        <a href="#dashboard" class="nav-link">
                            <i class="fas fa-th-large"></i>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#attendance" class="nav-link">
                            <i class="fas fa-user-check"></i>
                            <span>Profile</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#leave" class="nav-link">
                            <i class="fas fa-calendar-alt"></i>
                            <span>Leave Requests</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#reports" class="nav-link">
                            <i class="fas fa-chart-bar"></i>
                            <span>Reports</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#actions" class="nav-link">
                            <i class="fas fa-bolt"></i>
                            <span>Actions</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" id="sidebarLogoutLink">
                            <i class="fas fa-sign-out-alt"></i>
                            <span>Logout</span>
                        </a>
                    </li>
                </ul>
            </nav>
            <div class="sidebar-footer">
                <div class="user-profile">
                                        <i class="fas fa-user-circle profile-icon"></i>
                                        <div class="profile-info">
                                                <p class="profile-name">John Doe</p>
                                                <p class="profile-role">Employee</p>
                                        </div>
                                        <div class="profile-illus">
                                            <svg width="60" height="60" viewBox="0 0 60 60" fill="none"><circle cx="30" cy="30" r="28" fill="#6366f1"/><path d="M20 40c0-5 10-5 10-5s10 0 10 5v2H20v-2Z" fill="#fff"/><circle cx="30" cy="28" r="5" fill="#fff"/></svg>
                                        </div>
                </div>
            </div>
        </aside>

        <main class="main-content">
                        <!-- Logout Confirmation Modal -->
                        <div id="logoutModal" class="modal-overlay hidden">
                            <div class="modal-content">
                                <h2>Confirm Logout</h2>
                                <p>Are you sure you want to log out?</p>
                                <div class="modal-actions">
                                    <button id="confirmLogoutBtn" class="modal-btn confirm">Yes, Logout</button>
                                    <button id="cancelLogoutBtn" class="modal-btn cancel">Cancel</button>
                                </div>
                            </div>
                        </div>
            <header class="top-header">
                <div class="header-left">
                    <button class="menu-toggle" id="menuToggle" title="Toggle menu">
                        <i class="fas fa-bars"></i>
                    </button>
                    <div class="breadcrumb">
                        <i class="fas fa-home"></i>
                        <span>Home</span>
                        <span class="separator">/</span>
                        <span class="current">Dashboard</span>
                    </div>
                </div>
                <div class="header-right">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Search...">
                    </div>
                    <div class="header-actions">
                        <!-- Removed bell and message header actions -->
                    </div>
                </div>
            </header>
            
            <div id="main-content-area" class="main-content-area">
                <div id="dashboard" class="content-section active">
                    <div class="dashboard-content">
                        <div class="welcome-section">
                            <div class="welcome-text">
                                <h1>Welcome Back! ðŸ‘‹</h1>
                                <p>Here's what's happening with your attendance today</p>
                            </div>
                            <div class="dashboard-widgets">
                                <div class="widget-card clock-widget">
                                            <h1>Time</h1>
                                    <div class="widget-value" id="currentTime">--:-- --</div>
                                </div>
                                <div class="widget-card week-widget">
                                    <div class="widget-title"><i class="fas fa-calendar-week"></i> This Week</div>
                                    <div class="widget-value" id="currentWeek">--</div>
                                </div>
                                <div class="widget-card calendar-widget">
                                    <div class="widget-title"><i class="fas fa-calendar"></i> Calendar</div>
                                    <div class="widget-value" id="calendarDisplay"></div>
                                </div>
                            </div>
                        </div>

                        <div class="attendance-card">
                            <div class="attendance-info">
                                <h2 id="clockStatus">You are currently **Clocked Out**</h2>
                                <p id="lastActionTime">Last action: None recorded.</p>
                            </div>
                            <button id="clockButton" class="clock-btn clock-in">
                                <i class="fas fa-sign-in-alt"></i> Clock In
                            </button>
                        </div>
                        <div class="charts-section">
                            <div class="chart-card">
                                <div class="chart-header">
                                    <h3>Attendance Rate</h3>
                                    <div class="chart-actions">
                                        <button class="chart-btn active" data-period="today">Today</button>
                                        <button class="chart-btn" data-period="week">Week</button>
                                        <button class="chart-btn" data-period="month">Month</button>
                                    </div>
                                </div>
                                <div class="gauge-container">
                                    <canvas id="attendanceGauge"></canvas>
                                    <div class="gauge-center-text">
                                        <span id="gaugePercentage">0%</span>
                                        <span class="label">Attendance</span>
                                    </div>
                                </div>
                                <div class="chart-legend">
                                    <div class="legend-item">
                                        <i class="fas fa-circle success-color"></i>
                                        <span>Present: <span id="presentCount">0</span></span>
                                    </div>
                                    <div class="legend-item">
                                        <i class="fas fa-circle danger-color"></i>
                                        <span>Absent: <span id="absentCount">0</span></span>
                                    </div>
                                    <div class="legend-item">
                                        <i class="fas fa-circle warning-color"></i>
                                        <span>Leave: <span id="leaveCount">0</span></span>
                                    </div>
                                </div>
                            </div>

                            <div class="chart-card">
                                <div class="chart-header">
                                    <h3>On-Time Rate</h3>
                                    <div class="chart-actions">
                                        <button class="chart-btn active" data-period="today">Today</button>
                                        <button class="chart-btn" data-period="week">Week</button>
                                        <button class="chart-btn" data-period="month">Month</button>
                                    </div>
                                </div>
                                <div class="gauge-container">
                                    <canvas id="ontimeGauge"></canvas>
                                    <div class="gauge-center-text">
                                        <span id="ontimePercentage">0%</span>
                                        <span class="label">On-Time</span>
                                    </div>
                                </div>
                                <div class="chart-legend">
                                    <div class="legend-item">
                                        <i class="fas fa-circle info-color"></i>
                                        <span>On-Time: <span id="onTimeCount">0</span></span>
                                    </div>
                                    <div class="legend-item">
                                        <i class="fas fa-circle warning-color"></i>
                                        <span>Late: <span id="lateCount">0</span></span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="icon-container bg-red">
                                    <i class="fas fa-user-times"></i>
                                </div>
                                <div class="stat-info">
                                    <p class="stat-label">Total Absent</p>
                                    <h2 class="stat-value" data-target="12" id="totalAbsent">0</h2>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="icon-container bg-yellow">
                                    <i class="fas fa-calendar-day"></i>
                                </div>
                                <div class="stat-info">
                                    <p class="stat-label">Pending Leaves</p>
                                    <h2 class="stat-value" data-target="5" id="pendingLeaves">0</h2>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="icon-container bg-blue">
                                    <i class="fas fa-chart-line"></i>
                                </div>
                                <div class="stat-info">
                                    <p class="stat-label">Avg. Work Hours</p>
                                    <h2 class="stat-value" data-target="7.5" data-format="h" id="avgWorkHours">0h</h2>
                                </div>
                            </div>
                        </div>

                        <div class="two-column-grid">
                            <div class="activity-card">
                                <div class="section-header">
                                    <h3><i class="fas fa-history"></i> Recent Activity</h3>
                                    <a href="#" class="view-all">View All <i class="fas fa-chevron-right"></i></a>
                                </div>
                                <div class="activity-list" id="activityList">
                                    </div>
                            </div>
                        </div>
                    </div>
                </div>

<!-- PROFILE PAGE SECTION -->
<div id="profile" class="content-section"></div>

                                    </div>

<div id="leave" class="content-section"></div>


<!-- REPORTS SECTION -->
<div id="reports" class="content-section"></div>

<!-- ACTIONS SECTION -->
<div id="actions" class="content-section">
    <div class="dashboard-content actions-section">
        <h2>Actions</h2>
        <ul class="actions-list">
            <li>
                <a href="#" id="openResignationModalBtn" class="quick-action-btn">
                    <i class="fas fa-file-signature"></i>
                    <span>Resignation Request</span>
                </a>
            </li>
        </ul>
    </div>
</div>

<!-- SETTINGS SECTION -->




                </div>
            </div>
        </main>
    </div>
</div>

<!-- Selfie Capture Modal -->
<div id="selfieModal" class="modal-overlay selfie-modal hidden">
    <div class="modal-content selfie-modal-content">
        <h2>Take a Selfie to Clock In</h2>
        <video id="selfieVideo" width="320" height="240" autoplay class="hidden"></video>
        <canvas id="selfieCanvas" width="320" height="240" class="hidden"></canvas>
        <img id="selfiePreview" src="" alt="Selfie Preview" class="selfie-preview hidden"/>
        <label for="selfieFileInput" class="visually-hidden">Upload a selfie photo</label>
        <input type="file" id="selfieFileInput" accept="image/*" class="hidden" title="Upload a selfie photo" placeholder="Choose a selfie image"/>
        <div class="selfie-button-container">
            <button id="startCameraBtn">Use Camera</button>
            <button id="uploadPhotoBtn">Upload Photo</button>
        </div>
        <div id="selfieCaptureBtns" class="hidden">
            <button id="captureSelfieBtn">Capture</button>
            <button id="cancelCameraBtn">Cancel</button>
        </div>
        <div id="selfieConfirmBtns" class="hidden">
            <button id="confirmSelfieBtn">Confirm & Clock In</button>
            <button id="retakeSelfieBtn">Retake</button>
        </div>
        <button id="closeSelfieModalBtn" class="close-modal-btn">Close</button>
    </div>
</div>

<div id="resignationRequestModal" class="modal-overlay hidden">
    <div class="modal-content resignation-modal-content">
        <div class="resignation-card">
            <h3><i class="fas fa-file-signature"></i> Resignation Request</h3>
            <form id="resignationForm" enctype="multipart/form-data">
                <div class="form-group">
                    <label for="lastWorkingDay">Last Working Day</label>
                    <input type="date" id="lastWorkingDay" name="lastWorkingDay" required />
                </div>
                <div class="form-group">
                    <label for="resignReason">Reason</label>
                    <textarea id="resignReason" name="reason" rows="2" required></textarea>
                </div>
                <div class="form-group">
                    <label for="resignAttachment">Attachment (PDF/Image, optional)</label>
                    <input type="file" id="resignAttachment" name="attachment" accept=".pdf,image/*" />
                </div>
                <button type="submit" class="submit-btn">Submit Resignation</button>
            </form>
            <div id="resignationStatus" class="resignation-status"></div>
            <button id="closeResignationModalBtn" class="close-modal-btn modal-btn cancel" type="button">Close</button>
        </div>
    </div>
</div>

<script src="./employee-script.js" onerror="console.error('Failed to load script: ' + this.src)"></script>
</body>
</html>
